<?php

namespace TestAlg;

use \TestAlg\Points\Helper as PointsHelper;
use \TestAlg\Image\Image;
use \TestAlg\Algs\DP;
use \TestAlg\Algs\VW;

include 'conf.php';
//[[width,height],....]

$src0 = [[92,158],[80,158],[69,153],[67,147],[64,136],[63,131],[66,126],[70,124],[75,120],[77,118],[84,114],[96,109],[103,105],[104,101],[103,96],[98,92],[91,92],[83,91],[67,91],[59,89],[55,88],[49,83],[43,79],[43,74],[47,66],[55,63],[61,62],[71,64],[82,68],[93,70],[105,73],[111,66],[112,59],[118,55],[127,55],[129,64],[132,74],[136,77],[147,66],[154,41],[166,84],[169,52],[174,64],[178,56],[183,57],[152,13],[15,27],[70,37],[123,23],[91,52],[84,48],[78,55],[70,50],[65,54],[57,52],[27,74]];
$src1 = [[0,47.0489681],[0.8916692,40.7740439],[1.8033758,37.707202],[1.6297174,35.5652824],[4.3893276,30.6133378],[5.0572445,23.7116675],[6.5556049,17.9459426],[16.100138,17.9738878],[29.1234052,18.0170759],[36.6519424,16.6096616],[41.5833958,18.3422567],[47.8206269,18.967216],[50.5958218,18.2393674],[58.9458968,18.30669],[63.1671319,18.0081842],[63.1593395,20.9221381],[66.8718445,20.917057],[66.8440147,25.4303822],[68.119736,28.482966],[79.9351868,29.0355636],[77.9447943,31.2053255],[79.9485451,31.7833418],[82.7415512,37.8660052],[84.2721942,38.6841625],[86.9972953,41.6138171],[90.7242718,41.6570128],[76.8193542,10.0313412],[82.1727086,10.0046679],[84.745302,8.9224965],[89.3483629,10.1329541],[113.0082075,10.2129742],[122.2288009,10.2968049],[131.7132215,10.1494661],[151.3544325,10.3425307],[153.4539181,9.1180996],[154.2175698,6.2386988],[154.1975323,10.3628533],[177.6280587,10.5013012],[181.9672925,10.5063818],[211.6773514,10.5190835],[211.7018417,7.2979858],[214.5338095,7.2814741],[214.4124713,10.4708172],[219.2493031,10.5914828],[219.3294532,0.0114306],[224.1763038,0],[228.5277827,1.5202747],[228.4966132,10.6219668],[230.3322716,10.6575314],[260.8349253,10.7718464],[266.1259407,9.5029559],[267.3203988,14.9837864],[266.3151838,22.205111],[264.6465047,23.7434247],[261.9971008,23.5198537],[259.730636,20.5842482],[257.6834705,19.4308564],[255.1598577,20.4114929],[254.1590954,21.844353],[250.0569722,17.5623321],[247.4431906,17.0771044],[245.9537358,20.3251153],[240.1417452,23.4461769],[239.2066614,25.770825],[235.5698537,29.5792711],[232.8792616,30.4570839],[231.2573366,31.0427192],[229.5563748,29.4941579],[226.7010298,33.2811146],[226.7333125,35.7329759],[223.3213701,36.8001215],[216.78135,40.0130438],[207.3848718,45.2486608],[203.3551062,44.13698],[200.6856648,41.9403264],[194.8981645,41.8209027],[193.2573152,42.1397897],[191.8379917,43.1244059],[187.2549683,43.8244406],[179.5126977,43.5538278],[174.6736394,44.0112019],[171.6835979,45.0542748],[172.1856488,46.9625731],[173.8476488,47.8150908],[170.5024981,49.0043049],[169.8212228,47.425041],[170.918833,45.3757106],[166.0508317,47.2027005],[163.1954867,47.8189023],[152.4587219,48.1034996],[147.3892322,48.7781501],[142.4544392,53.9480437],[139.4577185,56.5985025],[135.6038377,58.8081058],[129.5046428,59.6619704],[126.506809,60.4726386],[118.9671399,65.9746406],[115.0364486,67.016616],[112.0530863,68.5973845],[111.4129992,69.9672297],[109.8589791,70.2417088],[111.1580776,71.2150974],[108.9739892,72.3486086],[107.1561419,74.7440089],[99.8769604,76.9412073],[95.9217789,78.6695093],[89.7235096,84.7479745],[88.886387,86.0696933],[86.9449751,87.1270778],[83.2046402,86.212033],[80.1767501,86.0696933],[74.7621701,87.3507563],[68.599523,88.081527],[67.1390113,89.5252877],[66.8184112,91.2537542],[67.9227005,92.7788905],[70.9505907,94.7310907],[71.9480133,96.6833197],[71.9658244,101.0352673],[73.6567675,102.5668717],[75.1061473,101.2119411],[75.1718258,106.5262468],[73.4263362,107.5227823],[70.8081017,107.8888585],[66.337511,109.2921599],[62.5259316,109.5972274],[61.22572,110.8175044],[61.3147756,113.0343698],[63.0246429,116.1652471],[65.8744219,116.9584653],[65.6595753,119.419506],[60.512162,124.5858066],[58.6776168,128.0233391],[59.3945144,120.8725076],[56.8208077,120.0068066],[55.6141044,116.9749908],[53.5424487,116.4804999],[53.0348318,115.0720375],[51.385077,116.6114318],[49.4982116,114.0017178],[49.8065666,112.0759269],[48.5853918,111.0831704],[49.6073047,107.8608943],[47.5712712,105.0339997],[44.2305733,101.1750811],[44.131499,99.1045813],[41.903996,95.8546356],[40.8386684,93.4067434],[37.1217106,90.7644434],[35.1580348,90.7428375],[32.8715325,89.6180651],[27.819854,80.8400853],[23.6598446,80.5617718],[23.6642974,79.0126308],[21.2909658,76.5180309],[18.4834883,74.5749951],[17.5762344,71.5937805],[13.7624287,71.5162648],[11.5983778,69.5110367],[8.5126015,66.1893886],[5.87099,62.2795064],[4.3425734,60.8462084],[3.1225118,58.5552511],[0.5721822,50.8897903]]; 
$src2 = [[14,111],[18,114],[22,110],[25,106],[30,106],[37,108],[44,112],[48,115],[56,118],[57,195],[61,118],[69,119],[73,120],[82,120],[83,117],[88,113],[90,47],[92,112],[99,115],[104,114],[111,110],[113,101],[111,91],[112,84],[115,80],[190,77],[116,75],[117,67],[120,64],[117,56],[116,53],[115,46],[114,37],[110,31],[10,27],[56,22],[74,25],[89,22],[91,13],[107,22],[110,26],[115,21],[117,14]];
$src3 = [[24,173],[26,170],[24,166],[27,162],[37,161],[45,157],[48,152],[46,143],[40,140],[34,137],[26,134],[24,130],[24,125],[28,121],[36,118],[46,117],[63,121],[76,125],[82,120],[86,111],[88,103],[90,91],[95,87],[107,89],[107,104],[106,117],[109,129],[119,131],[131,131],[139,134],[138,143],[131,152],[119,154],[111,149],[105,143],[91,139],[80,142],[81,152],[76,163],[67,161],[59,149],[63,138],[24,173]];
$src4 = [[-9063594.08989,3352185.86307],[-9063504.92297,3351558.37065],[-9063413.75231,3351251.68646],[-9063431.11815,3351037.4945],[-9063155.15713,3350542.30004],[-9063088.36544,3349852.13301],[-9062938.5294,3349275.56052],[-9061984.07609,3349278.35504],[-9060681.74937,3349282.67385],[-9059928.89565,3349141.93242],[-9059435.75031,3349315.19193],[-9058812.0272,3349377.68786],[-9058534.50771,3349304.903],[-9057699.50021,3349311.63526],[-9057277.3767,3349281.78468],[-9057278.15594,3349573.18007],[-9056906.90544,3349572.67196],[-9056909.68842,3350024.00448],[-9056782.11629,3350329.26286],[-9055600.57121,3350384.52262],[-9055799.61046,3350601.49881],[-9055599.23538,3350659.30044],[-9055319.93477,3351267.56678],[-9055166.87047,3351349.38251],[-9054894.36036,3351642.34797],[-9054521.66271,3351646.66754],[-9055912.15447,3348484.10038],[-9055376.81903,3348481.43305],[-9055119.55969,3348373.21591],[-9054659.2536,3348494.26167],[-9052293.26914,3348502.26368],[-9051371.2098,3348510.64675],[-9050422.76774,3348495.91287],[-9048458.64664,3348515.21933],[-9048248.69808,3348392.77622],[-9048172.33291,3348104.83614],[-9048174.33666,3348517.25159],[-9045831.28402,3348531.09638],[-9045397.36064,3348531.60444],[-9042426.35475,3348532.87461],[-9042423.90572,3348210.76484],[-9042140.70894,3348209.11367],[-9042152.84276,3348528.04798],[-9041669.15958,3348540.11454],[-9041661.14457,3347482.10932],[-9041176.45951,3347480.96626],[-9040741.31162,3347632.99373],[-9040744.42857,3348543.16294],[-9040560.86273,3348546.7194],[-9037510.59736,3348558.1509],[-9036981.49582,3348431.26185],[-9036862.05001,3348979.3449],[-9036962.57151,3349701.47736],[-9037129.43942,3349855.30873],[-9037394.37981,3349832.95163],[-9037621.02629,3349539.39108],[-9037825.74284,3349424.0519],[-9038078.10412,3349522.11555],[-9038178.18035,3349665.40156],[-9038588.39267,3349237.19947],[-9038849.77083,3349188.6767],[-9038998.71631,3349513.47779],[-9039579.91537,3349825.58395],[-9039673.42375,3350058.04876],[-9040037.10452,3350438.89337],[-9040306.16373,3350526.67465],[-9040468.35623,3350585.23818],[-9040638.45241,3350430.38205],[-9040923.98691,3350809.07772],[-9040920.75864,3351054.26385],[-9041261.95288,3351160.97841],[-9041915.95489,3351482.27064],[-9042855.60271,3352005.83234],[-9043258.57927,3351894.66426],[-9043525.52341,3351674.9989],[-9044104.27344,3351663.05653],[-9044268.35837,3351694.94523],[-9044410.29072,3351793.40685],[-9044868.59306,3351863.41032],[-9045642.82012,3351836.34904],[-9046126.72595,3351882.08645],[-9046425.7301,3351986.39374],[-9046375.52501,3352177.22357],[-9046209.32501,3352262.47534],[-9046543.84008,3352381.39675],[-9046611.96761,3352223.47036],[-9046502.20659,3352018.53732],[-9046989.00672,3352201.23631],[-9047274.54122,3352262.85649],[-9048348.2177,3352291.31622],[-9048855.16667,3352358.78127],[-9049348.64597,3352875.77063],[-9049648.31804,3353140.81651],[-9050033.70612,3353361.77684],[-9050643.62561,3353447.1633],[-9050943.40899,3353528.23012],[-9051697.3759,3354078.43032],[-9052090.44503,3354182.62786],[-9052388.78126,3354340.70471],[-9052452.78997,3354477.68923],[-9052608.19198,3354505.13714],[-9052478.28213,3354602.476],[-9052696.69097,3354715.82712],[-9052878.4757,3354955.36715],[-9053606.39385,3355175.08699],[-9054001.912,3355347.91719],[-9054621.73893,3355955.76371],[-9054705.45119,3356087.93559],[-9054899.59238,3356193.67404],[-9055273.62587,3356102.16956],[-9055576.41488,3356087.93559],[-9056117.87288,3356216.04189],[-9056734.13759,3356289.11896],[-9056880.18876,3356433.49503],[-9056912.24877,3356606.34168],[-9056801.81984,3356758.85531],[-9056499.03082,3356954.07533],[-9056399.28856,3357149.29823],[-9056397.50745,3357584.49299],[-9056228.41314,3357737.65343],[-9056083.47516,3357602.16037],[-9056076.90731,3358133.59094],[-9056251.45627,3358233.24449],[-9056513.27972,3358269.85211],[-9056960.33879,3358410.18225],[-9057341.49673,3358440.689],[-9057471.51789,3358562.7167],[-9057462.61233,3358784.40324],[-9057291.6256,3359097.49097],[-9057006.6477,3359176.81279],[-9057028.13236,3359422.91686],[-9057542.87369,3359939.54692],[-9057726.32821,3360283.30017],[-9057654.63845,3359568.21702],[-9057912.00912,3359481.64692],[-9058032.67945,3359178.46534],[-9058239.84502,3359129.01625],[-9058290.60671,3358988.17001],[-9058455.58219,3359142.10944],[-9058644.26873,3358881.13804],[-9058613.43323,3358688.55895],[-9058735.55071,3358589.2833],[-9058633.35942,3358267.05569],[-9058836.96277,3357984.36623],[-9059171.03256,3357598.47437],[-9059180.93999,3357391.42439],[-9059403.69029,3357066.42982],[-9059510.22305,3356821.6406],[-9059881.91883,3356557.4106],[-9060078.28641,3356555.25001],[-9060306.93664,3356442.77277],[-9060812.10449,3355564.97479],[-9061228.10543,3355537.14344],[-9061227.66015,3355382.22934],[-9061464.99331,3355132.76935],[-9061745.74106,3354938.46577],[-9061836.46645,3354640.34431],[-9062217.84702,3354632.59274],[-9062434.25211,3354432.06993],[-9062742.82974,3354099.90512],[-9063006.99089,3353708.9169],[-9063159.83255,3353565.5871],[-9063281.83871,3353336.49137],[-9063536.87167,3352569.94529],[-9063594.08989,3352185.86307],[],[],[],[-9056680.48159,3349959.98114],[-9056681.37215,3349764.48323],[-9056534.54174,3349957.82163],[-9056680.48159,3349959.98114],[],[-9063594.08989,3352185.86307],[-9063504.92297,3351558.37065],[-9063413.75231,3351251.68646],[-9063431.11815,3351037.4945],[-9063155.15713,3350542.30004],[-9063088.36544,3349852.13301],[-9062938.5294,3349275.56052],[-9061984.07609,3349278.35504],[-9060681.74937,3349282.67385],[-9059928.89565,3349141.93242],[-9059435.75031,3349315.19193],[-9058812.0272,3349377.68786],[-9058534.50771,3349304.903],[-9057699.50021,3349311.63526],[-9057277.3767,3349281.78468],[-9057278.15594,3349573.18007],[-9056906.90544,3349572.67196],[-9056909.68842,3350024.00448],[-9056782.11629,3350329.26286],[-9055600.57121,3350384.52262],[-9055799.61046,3350601.49881],[-9055599.23538,3350659.30044],[-9055319.93477,3351267.56678],[-9055166.87047,3351349.38251],[-9054894.36036,3351642.34797],[-9054521.66271,3351646.66754],[-9055912.15447,3348484.10038],[-9055376.81903,3348481.43305],[-9055119.55969,3348373.21591],[-9054659.2536,3348494.26167],[-9052293.26914,3348502.26368],[-9051371.2098,3348510.64675],[-9050422.76774,3348495.91287],[-9048458.64664,3348515.21933],[-9048248.69808,3348392.77622],[-9048172.33291,3348104.83614],[-9048174.33666,3348517.25159],[-9045831.28402,3348531.09638],[-9045397.36064,3348531.60444],[-9042426.35475,3348532.87461],[-9042423.90572,3348210.76484],[-9042140.70894,3348209.11367],[-9042152.84276,3348528.04798],[-9041669.15958,3348540.11454],[-9041661.14457,3347482.10932],[-9041176.45951,3347480.96626],[-9040741.31162,3347632.99373],[-9040744.42857,3348543.16294],[-9040560.86273,3348546.7194],[-9037510.59736,3348558.1509],[-9036981.49582,3348431.26185],[-9036862.05001,3348979.3449],[-9036962.57151,3349701.47736],[-9037129.43942,3349855.30873],[-9037394.37981,3349832.95163],[-9037621.02629,3349539.39108],[-9037825.74284,3349424.0519],[-9038078.10412,3349522.11555],[-9038178.18035,3349665.40156],[-9038588.39267,3349237.19947],[-9038849.77083,3349188.6767],[-9038998.71631,3349513.47779],[-9039579.91537,3349825.58395],[-9039673.42375,3350058.04876],[-9040037.10452,3350438.89337],[-9040306.16373,3350526.67465],[-9040468.35623,3350585.23818],[-9040638.45241,3350430.38205],[-9040923.98691,3350809.07772],[-9040920.75864,3351054.26385],[-9041261.95288,3351160.97841],[-9041915.95489,3351482.27064],[-9042855.60271,3352005.83234],[-9043258.57927,3351894.66426],[-9043525.52341,3351674.9989],[-9044104.27344,3351663.05653],[-9044268.35837,3351694.94523],[-9044410.29072,3351793.40685],[-9044868.59306,3351863.41032],[-9045642.82012,3351836.34904],[-9046126.72595,3351882.08645],[-9046425.7301,3351986.39374],[-9046375.52501,3352177.22357],[-9046209.32501,3352262.47534],[-9046543.84008,3352381.39675],[-9046611.96761,3352223.47036],[-9046502.20659,3352018.53732],[-9046989.00672,3352201.23631],[-9047274.54122,3352262.85649],[-9048348.2177,3352291.31622],[-9048855.16667,3352358.78127],[-9049348.64597,3352875.77063],[-9049648.31804,3353140.81651],[-9050033.70612,3353361.77684],[-9050643.62561,3353447.1633],[-9050943.40899,3353528.23012],[-9051697.3759,3354078.43032],[-9052090.44503,3354182.62786],[-9052388.78126,3354340.70471],[-9052452.78997,3354477.68923],[-9052608.19198,3354505.13714],[-9052478.28213,3354602.476],[-9052696.69097,3354715.82712],[-9052878.4757,3354955.36715],[-9053606.39385,3355175.08699],[-9054001.912,3355347.91719],[-9054621.73893,3355955.76371],[-9054705.45119,3356087.93559],[-9054899.59238,3356193.67404],[-9055273.62587,3356102.16956],[-9055576.41488,3356087.93559],[-9056117.87288,3356216.04189],[-9056734.13759,3356289.11896],[-9056880.18876,3356433.49503],[-9056912.24877,3356606.34168],[-9056801.81984,3356758.85531],[-9056499.03082,3356954.07533],[-9056399.28856,3357149.29823],[-9056397.50745,3357584.49299],[-9056228.41314,3357737.65343],[-9056083.47516,3357602.16037],[-9056076.90731,3358133.59094],[-9056251.45627,3358233.24449],[-9056513.27972,3358269.85211],[-9056960.33879,3358410.18225],[-9057341.49673,3358440.689],[-9057471.51789,3358562.7167],[-9057462.61233,3358784.40324],[-9057291.6256,3359097.49097],[-9057006.6477,3359176.81279],[-9057028.13236,3359422.91686],[-9057542.87369,3359939.54692],[-9057726.32821,3360283.30017],[-9057654.63845,3359568.21702],[-9057912.00912,3359481.64692],[-9058032.67945,3359178.46534],[-9058239.84502,3359129.01625],[-9058290.60671,3358988.17001],[-9058455.58219,3359142.10944],[-9058644.26873,3358881.13804],[-9058613.43323,3358688.55895],[-9058735.55071,3358589.2833],[-9058633.35942,3358267.05569],[-9058836.96277,3357984.36623],[-9059171.03256,3357598.47437],[-9059180.93999,3357391.42439],[-9059403.69029,3357066.42982],[-9059510.22305,3356821.6406],[-9059881.91883,3356557.4106],[-9060078.28641,3356555.25001],[-9060306.93664,3356442.77277],[-9060812.10449,3355564.97479],[-9061228.10543,3355537.14344],[-9061227.66015,3355382.22934],[-9061464.99331,3355132.76935],[-9061745.74106,3354938.46577],[-9061836.46645,3354640.34431],[-9062217.84702,3354632.59274],[-9062434.25211,3354432.06993],[-9062742.82974,3354099.90512],[-9063006.99089,3353708.9169],[-9063159.83255,3353565.5871],[-9063281.83871,3353336.49137],[-9063536.87167,3352569.94529],[-9063594.08989,3352185.86307]];


//==========================================================================================

$sigmaSquare = pow(isset($_REQUEST['sigma'])?$_REQUEST['sigma']:5, 2);

$src_array = isset($_REQUEST['src']) ? 'src'.$_REQUEST['src'] : 'src0';
$src = isset($$src_array) ? $$src_array : $src0;

$src_array = PointsHelper::multiplicateCoordinatesArray($src, 4);
$src_points = PointsHelper::fromArrayToPoints($src_array);
$DP_points = DP::run($src_points, $sigmaSquare);
$VW_points = VW::run($src_points, count($src_points) - count($resPoints1));
$DP_points2 = DP::runWithoutRecursion($src_points, $sigmaSquare);

$image = new Image();
$image
    ->addPoints(PointsHelper::fromPointsToArray($VW_points), Image::YELLOW)
    ->addPoints(PointsHelper::fromPointsToArray($DP_points), Image::RED)
    ->addPoints(PointsHelper::fromPointsToArray($DP_points2), Image::GREEN)
    ->addPoints($src_array, Image::BLUE)
    
    ->printImage()
;
